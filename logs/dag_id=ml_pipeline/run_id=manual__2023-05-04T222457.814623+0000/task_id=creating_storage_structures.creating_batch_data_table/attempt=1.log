[2023-05-04T22:25:00.248+0000] {taskinstance.py:1090} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ml_pipeline.creating_storage_structures.creating_batch_data_table manual__2023-05-04T22:24:57.814623+00:00 [queued]>
[2023-05-04T22:25:00.261+0000] {taskinstance.py:1090} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ml_pipeline.creating_storage_structures.creating_batch_data_table manual__2023-05-04T22:24:57.814623+00:00 [queued]>
[2023-05-04T22:25:00.314+0000] {taskinstance.py:1288} INFO - 
--------------------------------------------------------------------------------
[2023-05-04T22:25:00.316+0000] {taskinstance.py:1289} INFO - Starting attempt 1 of 1
[2023-05-04T22:25:00.318+0000] {taskinstance.py:1290} INFO - 
--------------------------------------------------------------------------------
[2023-05-04T22:25:00.385+0000] {taskinstance.py:1309} INFO - Executing <Task(PostgresOperator): creating_storage_structures.creating_batch_data_table> on 2023-05-04 22:24:57.814623+00:00
[2023-05-04T22:25:00.393+0000] {standard_task_runner.py:55} INFO - Started process 23184 to run task
[2023-05-04T22:25:00.400+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'ml_pipeline', 'creating_storage_structures.creating_batch_data_table', 'manual__2023-05-04T22:24:57.814623+00:00', '--job-id', '678', '--raw', '--subdir', 'DAGS_FOLDER/ml_pipeline.py', '--cfg-path', '/tmp/tmps081mmzr']
[2023-05-04T22:25:00.403+0000] {standard_task_runner.py:83} INFO - Job 678: Subtask creating_storage_structures.creating_batch_data_table
[2023-05-04T22:25:00.492+0000] {task_command.py:389} INFO - Running <TaskInstance: ml_pipeline.creating_storage_structures.creating_batch_data_table manual__2023-05-04T22:24:57.814623+00:00 [running]> on host ab75f0ddb6b9
[2023-05-04T22:25:00.693+0000] {taskinstance.py:1518} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=nomadicsenseis@gmail.com
AIRFLOW_CTX_DAG_OWNER=Diego Rivera
AIRFLOW_CTX_DAG_ID=ml_pipeline
AIRFLOW_CTX_TASK_ID=creating_storage_structures.creating_batch_data_table
AIRFLOW_CTX_EXECUTION_DATE=2023-05-04T22:24:57.814623+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-05-04T22:24:57.814623+00:00
[2023-05-04T22:25:00.694+0000] {sql.py:254} INFO - Executing: CREATE TABLE IF NOT EXISTS batch_data (
    Customer_ID SERIAL PRIMARY KEY,
    rev_mean FLOAT,
    mou_mean FLOAT,
    totmrc_mean FLOAT,
    da_mean FLOAT,
    ovrmou_mean FLOAT,
    ovrrev_mean FLOAT,
    vceovr_mean FLOAT,
    datovr_mean FLOAT,
    roam_mean FLOAT,
    change_mou FLOAT,
    change_rev FLOAT,
    drop_vce_mean FLOAT,
    drop_dat_mean FLOAT,
    blck_vce_mean FLOAT,
    blck_dat_mean FLOAT,
    unan_vce_mean FLOAT,
    unan_dat_mean FLOAT,
    plcd_vce_mean FLOAT,
    plcd_dat_mean FLOAT,
    recv_vce_mean FLOAT,
    recv_sms_mean FLOAT,
    comp_vce_mean FLOAT,
    comp_dat_mean FLOAT,
    custcare_mean FLOAT,
    ccrndmou_mean FLOAT,
    cc_mou_mean FLOAT,
    inonemin_mean FLOAT,
    threeway_mean FLOAT,
    mou_cvce_mean FLOAT,
    mou_cdat_mean FLOAT,
    mou_rvce_mean FLOAT,
    owylis_vce_mean FLOAT,
    mouowylisv_mean FLOAT,
    iwylis_vce_mean FLOAT,
    mouiwylisv_mean FLOAT,
    peak_vce_mean FLOAT,
    peak_dat_mean FLOAT,
    mou_peav_mean FLOAT,
    mou_pead_mean FLOAT,
    opk_vce_mean FLOAT,
    opk_dat_mean FLOAT,
    mou_opkv_mean FLOAT,
    mou_opkd_mean FLOAT,
    drop_blk_mean FLOAT,
    attempt_mean FLOAT,
    complete_mean FLOAT,
    callfwdv_mean FLOAT,
    callwait_mean FLOAT,
    churn FLOAT,
    months FLOAT,
    uniqsubs FLOAT,
    actvsubs FLOAT,
    new_cell VARCHAR(255),
    crclscod VARCHAR(255),
    asl_flag VARCHAR(255),
    totcalls FLOAT,
    totmou FLOAT,
    totrev FLOAT,
    adjrev FLOAT,
    adjmou FLOAT,
    adjqty FLOAT,
    avgrev FLOAT,
    avgmou FLOAT,
    avgqty FLOAT,
    avg3mou FLOAT,
    avg3qty FLOAT,
    avg3rev FLOAT,
    avg6mou FLOAT,
    avg6qty FLOAT,
    avg6rev FLOAT,
    prizm_social_one VARCHAR(255),
    area VARCHAR(255),
    dualband VARCHAR(255),
    refurb_new VARCHAR(255),
    hnd_price FLOAT,
    phones FLOAT,
    models FLOAT,
    hnd_webcap VARCHAR(255),
    truck FLOAT,
    rv FLOAT,
    ownrent VARCHAR(255),
    lor FLOAT,
    dwlltype VARCHAR(255),
    marital VARCHAR(255),
    adults FLOAT,
    infobase VARCHAR(255),
    income FLOAT,
    numbcars FLOAT,
    HHstatin VARCHAR(255),
    dwllsize VARCHAR(255),
    forgntvl FLOAT,
    ethnic VARCHAR(255),
    kid0_2 VARCHAR(255),
    kid3_5 VARCHAR(255),
    kid6_10 VARCHAR(255),
    kid11_15 VARCHAR(255),
    kid16_17 VARCHAR(255),
    creditcd VARCHAR(255),
    eqpdays FLOAT   
);

    
[2023-05-04T22:25:00.706+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2023-05-04T22:25:01.115+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2023-05-04T22:25:01.183+0000] {sql.py:375} INFO - Running statement: CREATE TABLE IF NOT EXISTS batch_data (
    Customer_ID SERIAL PRIMARY KEY,
    rev_mean FLOAT,
    mou_mean FLOAT,
    totmrc_mean FLOAT,
    da_mean FLOAT,
    ovrmou_mean FLOAT,
    ovrrev_mean FLOAT,
    vceovr_mean FLOAT,
    datovr_mean FLOAT,
    roam_mean FLOAT,
    change_mou FLOAT,
    change_rev FLOAT,
    drop_vce_mean FLOAT,
    drop_dat_mean FLOAT,
    blck_vce_mean FLOAT,
    blck_dat_mean FLOAT,
    unan_vce_mean FLOAT,
    unan_dat_mean FLOAT,
    plcd_vce_mean FLOAT,
    plcd_dat_mean FLOAT,
    recv_vce_mean FLOAT,
    recv_sms_mean FLOAT,
    comp_vce_mean FLOAT,
    comp_dat_mean FLOAT,
    custcare_mean FLOAT,
    ccrndmou_mean FLOAT,
    cc_mou_mean FLOAT,
    inonemin_mean FLOAT,
    threeway_mean FLOAT,
    mou_cvce_mean FLOAT,
    mou_cdat_mean FLOAT,
    mou_rvce_mean FLOAT,
    owylis_vce_mean FLOAT,
    mouowylisv_mean FLOAT,
    iwylis_vce_mean FLOAT,
    mouiwylisv_mean FLOAT,
    peak_vce_mean FLOAT,
    peak_dat_mean FLOAT,
    mou_peav_mean FLOAT,
    mou_pead_mean FLOAT,
    opk_vce_mean FLOAT,
    opk_dat_mean FLOAT,
    mou_opkv_mean FLOAT,
    mou_opkd_mean FLOAT,
    drop_blk_mean FLOAT,
    attempt_mean FLOAT,
    complete_mean FLOAT,
    callfwdv_mean FLOAT,
    callwait_mean FLOAT,
    churn FLOAT,
    months FLOAT,
    uniqsubs FLOAT,
    actvsubs FLOAT,
    new_cell VARCHAR(255),
    crclscod VARCHAR(255),
    asl_flag VARCHAR(255),
    totcalls FLOAT,
    totmou FLOAT,
    totrev FLOAT,
    adjrev FLOAT,
    adjmou FLOAT,
    adjqty FLOAT,
    avgrev FLOAT,
    avgmou FLOAT,
    avgqty FLOAT,
    avg3mou FLOAT,
    avg3qty FLOAT,
    avg3rev FLOAT,
    avg6mou FLOAT,
    avg6qty FLOAT,
    avg6rev FLOAT,
    prizm_social_one VARCHAR(255),
    area VARCHAR(255),
    dualband VARCHAR(255),
    refurb_new VARCHAR(255),
    hnd_price FLOAT,
    phones FLOAT,
    models FLOAT,
    hnd_webcap VARCHAR(255),
    truck FLOAT,
    rv FLOAT,
    ownrent VARCHAR(255),
    lor FLOAT,
    dwlltype VARCHAR(255),
    marital VARCHAR(255),
    adults FLOAT,
    infobase VARCHAR(255),
    income FLOAT,
    numbcars FLOAT,
    HHstatin VARCHAR(255),
    dwllsize VARCHAR(255),
    forgntvl FLOAT,
    ethnic VARCHAR(255),
    kid0_2 VARCHAR(255),
    kid3_5 VARCHAR(255),
    kid6_10 VARCHAR(255),
    kid11_15 VARCHAR(255),
    kid16_17 VARCHAR(255),
    creditcd VARCHAR(255),
    eqpdays FLOAT   
);

    , parameters: None
[2023-05-04T22:25:01.213+0000] {taskinstance.py:1332} INFO - Marking task as SUCCESS. dag_id=ml_pipeline, task_id=creating_storage_structures.creating_batch_data_table, execution_date=20230504T222457, start_date=20230504T222500, end_date=20230504T222501
[2023-05-04T22:25:01.296+0000] {local_task_job.py:212} INFO - Task exited with return code 0
[2023-05-04T22:25:01.364+0000] {taskinstance.py:2596} INFO - 0 downstream tasks scheduled from follow-on schedule check
